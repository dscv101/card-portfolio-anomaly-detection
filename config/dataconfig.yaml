# Data Configuration for Anomaly Detection System
# Version: 1.0.0
# Spec Reference: REQ-3.x requirements from REQUIREMENTS.md

datasource:
  type: csv  # Options: sql, csv
  # sql:
  #   connection_string: ${DB_CONNECTION_STRING}
  #   query_template: |
  #     SELECT customer_id, reporting_week, mcc, 
  #            spend_amount, transaction_count, avg_ticket_amount
  #     FROM card_transactions
  #     WHERE reporting_week = '{reporting_week}'
  #     ORDER BY customer_id, mcc
  #   timeout: 60  # Query timeout in seconds
  #   max_retries: 3  # Maximum connection retry attempts
  csv:
    directory: ./datasamples
    filename_pattern: transactions_{reporting_week}.parquet  # Supports .csv and .parquet

schema:
  required_columns:
    - customer_id: {type: string, nullable: false}
    - reporting_week: {type: date, nullable: false}
    - mcc: {type: string, nullable: false}
    - spend_amount: {type: float, nullable: false}
    - transaction_count: {type: int, nullable: false}
    - avg_ticket_amount: {type: float, nullable: false}

validation:
  rules:
    missing_critical: {severity: CRITICAL, action: reject_row}
    negative_spend: {severity: ERROR, action: flag_for_review}
    negative_txn_count: {severity: ERROR, action: flag_for_review}
    avg_ticket_mismatch: {severity: WARNING, action: recalculate, tolerance: 0.01}
    duplicates: {severity: ERROR, action: keep_first}
    extreme_ticket: {severity: WARNING, action: flag, multiplier: 10}
